; Configuration file for Duet 3 (firmware version 3)
; executed by the firmware on start-up
;
; generated by RepRapFirmware Configuration Tool v3.1.4 on Fri Oct 30 2020 10:16:50 GMT+0000 (Greenwich Mean Time)

; General preferences
M111 S0 						; Debugging off
G21 							; Work in millimetres
G90                             ; send absolute coordinates...
M83                             ; ...but relative extruder moves
M550 P"duet3"                   ; set printer name
;M564 S1 H0						; allow movement of axes that have not been homed but within limits

G4 S3

M669 K1							; select CoreXY mode with movement coefficient

; Drive direction
M569 P0.0 S1 						; Drive 0 (X)
M569 P0.1 S1 						; Drive 1 (Y)
M569 P0.2 S0 						; Drive 2 (Z)
M569 P0.3 S1 						; Drive 3 (E0)
M569 P0.4 S1 						; Drive 4 (E1)
M569 P0.5 S0 						; Drive 5 (COUPLER)
M569 P1.0 S0						; Drive 1.0 (E2)
M569 P1.1 S0	 					; Drive 1.1 (E3)
M569 P1.2 S1						; Drive 1.2 (Brush)

M584 X0.0 Y0.1 Z0.2 C0.5								; set axis drivers
M584 E0.3:0.4:1.0:1.1									; set extruder drivers
M584 B1.2 												; set brush driver

; Axis Limits
M208 X-35 Y-49 Z0 C0 B0 S1   	                        	; set axis minima
M208 X328.5 Y245 Z300 C280 B360 S0    	                    ; set axis maxima

M92 X100 Y100 Z1600 C100 B100 E432:432:390:390				; Set steps per mm assuming x16 microstepping
M350 E16:16:16:16 I1		 								; Configure microstepping with interpolation
M350 C8 I0 													; Configure microstepping without interpolation
M350 X16 Y16 Z16 B16 I1										; Configure microstepping with interpolation
M566 X400 Y400 Z100 C2 B300 E200:200:200:200				; Set maximum instantaneous speed changes (mm/min)
M203 X30000 Y30000 Z1500 C5000 B15000 E5000:5000:5000:5000	; Set maximum speeds (mm/min)
M201 X6000 Y6000 Z400 C500 B800 E8000:8000:8000:8000		; Set accelerations (mm/s^2)
M906 X1200 Y1200 Z1000 I30									; Set motor currents (mA) and motor idle factor in percent
M906 C400 B1800 E1000:1000:1000:1000 I10 					; Set motor currents (mA) and motor idle factor in percent
M84 S120 													; Set idle timeout

; Endstops
;M574 X1 Y1 S3				 							; Set X / Y endstop stall detection
M574 X1 S1 P"io5.in"                                    ; configure active-high endstop for low end on X via pin io5.in
M574 Y1 S1 P"io6.in" 									; configure active-high endstop for low end on Y via pin io6.in
M574 Z0	C0												; No Z endstop
M574 C1 S3												; Stall detect coupler at low end of its range
M574 B1 S3												; Stall detect coupler at low end of its range (Brush)

; Z-Probe
M558 P8 C"io3.in" H3 F360 I0 T20000 					; Set Z probe type to switch, the axes for which it is used and the dive height + speeds
G31 P200 X0 Y0 Z0	 									; Set Z probe trigger value, offset and trigger height
M557 X0:285 Y20:180 S40 								; Define mesh grid

;Stall Detection
;M915 C S3 F1 H400 R0										; Coupler
M915 C S6 F0 H200 R0										; C (Coupler)
;M915 B S-20 F0 H200 R0										; B (Brush)
;M915 P0.0:0.1 S1 F0 H280 R0								; X / Y Axes
;M915 P0.0:0.1 S3 F0 H400									; X / Y Axes

; Heaters
; Bed
M308 S0 P"temp0" Y"thermistor" A"High Temp Bed" T100000 B4138 C0            ; configure sensor 0 as thermistor on pin temp0
M950 H0 C"out0" T0 Q10                               		      	  		; create bed heater output on out0 and map it to sensor 0
M307 H0 B0 S1.00															; disable bang-bang mode for the bed heater and set PWM limit
M140 H0                                                 	 		  		; map heated bed to heater 0
M143 H0 S150                                            			  		; set temperature limit for heater 0 to 150C

; Tool 0 heater
M308 S1 P"temp1" Y"thermistor" A"T0 Titan" T100000 B4725 C7.06e-8    		; configure sensor 1 as thermistor on pin temp1
M950 H1 C"out1" T1                                      			 		; create nozzle heater output on out1 and map it to sensor 1
M307 H1 B0 S1.00                                         		      		; disable bang-bang mode for heater  and set PWM limit
M143 H1 S300                                              		      		; set temperature limit for heater 1 to 300C

; Tool 1 heater
M308 S2 P"temp2" Y"thermistor" A"T1 Titan" T100000 B4725 C7.06e-8 			; Set thermistor
M950 H2 C"out2" T2															; Extruder 0 heater
M307 H2 B0 S1.00                                         		      		; disable bang-bang mode for heater  and set PWM limit
M143 H2 S300 																; Set temperature limit for heater 2 to 300C

; Tool 2 heater
M308 S3 P"1.temp0" Y"thermistor" A"T2 Hemera" T100000 B4725 C7.06e-8		; Set thermistor
M950 H3 C"1.out0" T3														; Extruder 0 heater
M307 H3 B0 S1.00                                         		      		; disable bang-bang mode for heater  and set PWM limit
M143 H3 S300

; Tool 3 heater
M308 S4 P"1.temp1" Y"thermistor" A"T3 Hemera" T100000 B4725 C7.06e-8 		; Set thermistor
M950 H4 C"1.out1" T4														; Extruder 0 heater
M307 H4 B0 S1.00                                         		      		; disable bang-bang mode for heater  and set PWM limit
M143 H4 S300

M308 S10 Y"mcu-temp" A"6HC MCU"
;M308 S11 Y"drivers" A"6HC Steppers"
M308 S12 Y"mcu-temp" P"1.dummy" A"3HC MCU"
;M308 S13 Y"drivers" P"1.dummy" A"3HC Steppers"

; Fans
; Tool 0 Fans
M950 F0 C"out4" Q500                                    			; create fan 0 on pin out4 and set its frequency
M106 P0 C"Part Cooling T0" S0 H-1                                   ; set fan 0 value. Thermostatic control is turned off

M950 F1 C"out7" Q500                                    			; create fan 1 on pin out7 and set its frequency
M106 P1 C"Heatsink" S1 H1 T50                                       ; set fan 1 value. Thermostatic control is turned on

; Tool 1 Fans
M950 F2 C"out5" Q500                                    			; create fan 2 on pin out5 and set its frequency
M106 P2 C"Part Cooling T1" S0 H-1                                   ; set fan 2 value. Thermostatic control is turned off

M950 F3 C"out8" Q500                                    			; create fan 3 on pin out8 and set its frequency
M106 P3 C"Heatsink" S1 H2 T50                                       ; set fan 3 value. Thermostatic control is turned on

; Tool 2 Fans
M950 F4 C"1.out3" Q500                                    			; create fan 4 on pin out and set its frequency
M106 P4 C"Part Cooling T2" S0 H-1                                   ; set fan 4 value. Thermostatic control is turned off

M950 F5 C"1.out6" Q500                                    			; create fan 5 on pin out and set its frequency
M106 P5 C"Heatsink" S1 H3 T50                                       ; set fan 5 value. Thermostatic control is turned on

; Tool 3 Fans
M950 F6 C"1.out4" Q500                                    			; create fan 6 on pin out and set its frequency
M106 P6 C"Part Cooling T3" S0 H-1                                   ; set fan 6 value. Thermostatic control is turned off

M950 F7 C"1.out7" Q500                                    			; create fan 7 on pin out and set its frequency
M106 P7 C"Heatsink" S1 H4 T50                                       ; set fan 7 value. Thermostatic control is turned on

; Toolhead LED
M950 F8 C"out6" Q500                                    			; create fan 8 on pin out and set its frequency
M106 P8 C"Nozzle LED" S0 B0	                                        ; set fan 8 value. Thermostatic control is turned off

;Input Shaping
;M593 F42.2
M593 P"zvdd" F42.8

; Tools
										;If you have to move the nozzle closer to the bed, increase the G10 Z value by the amount of baby stepping used. 
										;If you have to move the nozzle farther away from the bed, decrease the G10 Z value by the amount of baby stepping used.

M563 P0 S"T0" D0 H1 F0 					; Define tool 0
G10 P0 X-8.77 Y39.60 Z-4.70 			; Set offset
G10 P0 R0 S0 							; Reset initial tool 0 active and standby temperatures to 0C
M572 D0 S0
M207 P0 S5.0 F2400 Z0.5

M563 P1 S"T1" D1 H2 F2 					; Define tool 1
G10 P1 X-8.69 Y39.75 Z-3.30				; Set offset
G10 P1 R0 S0 							; Reset initial tool 1 active and standby temperatures to 0C
M572 D1 S0
M207 P1 S5.0 F2400 Z0.5

M563 P2 S"T2" D2 H3 F4 					; Define tool 2
G10 P2 X-8.58 Y39.76 Z-3.35  			; Set tool 2 axis offsets
G10 P2 R0 S0 							; Reset initial tool 2 active and standby temperatures to 0C
M572 D2 S0
M207 P2 S5.0 F2400 Z0.5

M563 P3 S"T3" D3 H4 F6 					; Define tool 3
G10 P3 X-8.49 Y39.70 Z-3.60 			; Set tool 3 axis offsets
G10 P3 R0 S0 							; Reset initial tool 3 active and standby temperatures to 0C
M572 D3 S0
M207 P3 S5.0 F2400 Z0.5

; Custom settings are not defined
M575 P1 S1 B57600						; Setup Paneldue
G29 S2							    	; Disable mesh
T-1								        ; Deselect tools
M912 P0 S-9.8							; Calibrate MCU Temperature
M501									; Call config_override.g